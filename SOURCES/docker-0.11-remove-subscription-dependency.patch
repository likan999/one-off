From 248d8fe6b6b4b4706d5c8b14035d5a6847e88721 Mon Sep 17 00:00:00 2001
From: Jim Perrin <jperrin@centos.org>
Date: Thu, 26 Jun 2014 09:23:14 -0500
Subject: [PATCH] remove subscription manager sharing between container and
 host

---
 daemon/container.go | 12 ++++++------
 daemon/volumes.go   |  2 +-
 graph/graph.go      |  2 +-
 3 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/daemon/container.go b/daemon/container.go
index ce84057..c182009 100644
--- a/daemon/container.go
+++ b/daemon/container.go
@@ -290,9 +290,9 @@ func (container *Container) Start() (err error) {
 	if err := populateCommand(container, env); err != nil {
 		return err
 	}
-	if err := container.setupSecretFiles(); err != nil {
-		return err
-	}
+//	if err := container.setupSecretFiles(); err != nil {
+//		return err
+//	}
 	if err := setupMountsForContainer(container); err != nil {
 		return err
 	}
@@ -308,9 +308,9 @@ func (container *Container) Start() (err error) {
 	}
 
 	// Now the container is running, unmount the secrets on the host
-	if err := system.Unmount(container.secretsPath(), syscall.MNT_DETACH); err != nil {
-		return err
-	}
+//	if err := system.Unmount(container.secretsPath(), syscall.MNT_DETACH); err != nil {
+//		return err
+//	}
 
 	return nil
 }
diff --git a/daemon/volumes.go b/daemon/volumes.go
index 7d92baf..7e9cadd 100644
--- a/daemon/volumes.go
+++ b/daemon/volumes.go
@@ -38,7 +38,7 @@ func setupMountsForContainer(container *Container) error {
 	mounts := []execdriver.Mount{
 		{container.daemon.sysInitPath, "/.dockerinit", false, true},
 		{container.ResolvConfPath, "/etc/resolv.conf", false, true},
-		{container.secretsPath(), "/run/secrets", true, true},
+//		{container.secretsPath(), "/run/secrets", true, true},
 	}
 
 	if container.HostnamePath != "" {
diff --git a/graph/graph.go b/graph/graph.go
index f578ad9..06d714b 100644
--- a/graph/graph.go
+++ b/graph/graph.go
@@ -257,7 +257,7 @@ func SetupInitLayer(initLayer string) error {
 		"/dev/pts":         "dir",
 		"/dev/shm":         "dir",
 		"/proc":            "dir",
-		"/run/secrets":     "dir",
+		//"/run/secrets":     "dir",
 		"/sys":             "dir",
 		"/.dockerinit":     "file",
 		"/.dockerenv":      "file",
-- 
1.8.3.1

